#!/bin/sh

# Pre-push hook - Run type checking before pushing

# Colors for output
RED='\033[0;31m'
YELLOW='\033[1;33m'
GREEN='\033[0;32m'
NC='\033[0m' # No Color

echo "${YELLOW}üîç Running pre-push validation...${NC}\n"

# Run type checking on backend
echo "${YELLOW}üîÑ Type checking Convex backend...${NC}"
if ! (cd packages/backend && bun run check-types); then
  echo "\n${RED}‚ùå Pre-push validation failed!${NC}"
  echo "${RED}   Type errors in Convex backend.${NC}\n"
  echo "To skip this check (not recommended):"
  echo "  ${YELLOW}git push --no-verify${NC}\n"
  exit 1
fi
echo "${GREEN}‚úÖ Backend type check passed${NC}\n"

echo "${GREEN}‚úÖ Pre-push validation complete!${NC}\n"
exit 0
